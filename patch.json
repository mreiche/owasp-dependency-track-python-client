{
  "components": {
    "schemas": {
      "Analysis" : {
        "required": []
      },
      "Project": {
        "required": [],
        "properties": {
          "children": {
            "nullable": true
          }
        }
      },
      "Component": {
        "required": [
          "project",
          "uuid"
        ]
      },
      "Finding": {
        "type": "object",
        "properties": {
          "component": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "uuid": {
                "type": "string"
              },
              "group": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "version": {
                "type": "string"
              },
              "purl": {
                "type": "string"
              },
              "project": {
                "type": "string"
              },
              "projectName": {
                "type": "string"
              },
              "projectVersion": {
                "type": "string"
              },
              "latestVersion": {
                "type": "string"
              }
            }
          },
          "vulnerability": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "uuid": {
                "type" : "string"
              },
              "source": {
                "type" : "string"
              },
              "vulnId": {
                "type" : "string"
              },
              "description": {
                "type" : "string"
              },
              "cvssV3BaseScore": {
                "type" : "number"
              },
              "severity": {
                "type" : "string"
              },
              "severityRank": {
                "type" : "integer"
              },
              "epssScore": {
                "type" : "number"
              },
              "epssPercentile": {
                "type" : "number"
              },
              "cweId": {
                "type" : "integer"
              },
              "cweName": {
                "type" : "string"
              },
              "cwes": {
                "type" : "array",
                "items" : {
                  "$ref" : "#/components/schemas/Cwe"
                }
              },
              "recommendation": {
                "type" : "string"
              },
              "published": {
                "type" : "integer"
              },
              "aliases": {
                "type": "array",
                "items": {
                  "$ref" : "#/components/schemas/VulnerabilityAlias"
                }
              }
            }
          },
          "analysis": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "state": {
                "type" : "string",
                "enum" : [ "EXPLOITABLE", "IN_TRIAGE", "FALSE_POSITIVE", "NOT_AFFECTED", "RESOLVED", "NOT_SET" ]
              },
              "isSuppressed" : {
                "type" : "boolean"
              }
            }
          },
          "attribution": {
            "$ref": "#/components/schemas/FindingAttrib"
          }
        }
      },
      "Vulnerability": {
        "properties": {
          "findingAttribution": {
            "$ref": "#/components/schemas/FindingAttrib"
          }
        }
      },
      "FindingAttrib": {
        "type": "object",
        "properties": {
          "attributedOn": {
            "type": "integer",
            "description": "UNIX epoch timestamp in milliseconds",
            "format": "int64"
          },
          "analyzerIdentity": {
            "type": "string",
            "enum": [
              "INTERNAL_ANALYZER",
              "OSSINDEX_ANALYZER",
              "NPM_AUDIT_ANALYZER",
              "VULNDB_ANALYZER",
              "SNYK_ANALYZER",
              "TRIVY_ANALYZER",
              "NONE"
            ]
          },
          "component": {
            "$ref": "#/components/schemas/Component"
          },
          "vulnerability": {
            "$ref": "#/components/schemas/Vulnerability"
          },
          "alternateIdentifier": {
            "type": "string"
          },
          "referenceUrl": {
            "type": "string"
          },
          "uuid": {
            "type": "string",
            "format": "uuid"
          }
        }
      }
    }
  }
}
